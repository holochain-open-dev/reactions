<!DOCTYPE html>
  <html lang="en-GB">
    <head>
      <meta charset="utf-8" />
      <link
        href="https://fonts.googleapis.com/css?family=Material+Icons&display=block"
        rel="stylesheet"
      />

      <link
        rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
      />
    </head>

    <link rel="stylesheet" href="styles.css" />

    <body>
      <reactions-test-app></reactions-test-app>

      <script type="module">
        import {
          ProfilesService,
          ProfilesStore,
          ProfilePrompt,
          SearchAgent,
          profilesStoreContext,
        } from '@holochain-open-dev/profiles';

        import { EmojiReaction, ReactionsStore, reactionsStoreContext } from '../dist';

        import { ContextProvider } from '@holochain-open-dev/context';
        import { HolochainClient } from '@holochain-open-dev/cell-client';
        import { ScopedElementsMixin } from '@open-wc/scoped-elements';
        import { LitElement, html } from 'lit';

        class ReactionsTestApp extends ScopedElementsMixin(LitElement) {
          static get properties() {
            return {
              loaded: {
                type: Boolean,
              },
            };
          }

          async firstUpdated() {
            const client = await HolochainClient.connect(
              `ws://localhost:${process.env.HC_PORT}`,
              'test-app'
            );
            const cellClient = client.forCell(
              client.cellDataByRoleId('reactions')
            );

            const profilesStore = new ProfilesStore(cellClient);
            new ContextProvider(this, profilesStoreContext, profilesStore);

            new ContextProvider(
              this,
              reactionsStoreContext,
              new ReactionsStore(cellClient)
            );
            this.loaded = true;
          }

          render() {
            if (!this.loaded) return html`<span>Loading...</span>`;
            return html`
              <emoji-reactions entryHash="[NO VALID ENTRY HASH YET]"></emoji-reactions>
            `;
          }

          static get scopedElements() {
            return {
              'emoji-reactions': EmojiReaction
            };
          }
        }

        customElements.define('reactions-test-app', ReactionsTestApp);
      </script>
    </body>
  </html>
